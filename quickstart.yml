---
  - name: "Playing with Ansible and Git"
    hosts: localhost
    connection: local
    tasks:

    - name: System details
      when: ansible_distribution == 'Ubuntu' and  ansible_distribution_version == "20.04"
      debug: msg="{{ item }}"
      with_items: 
      - "{{ ansible_distribution }}"
      - "{{ ansible_distribution_version }}"
      - "{{ ansible_distribution_release  }}"
      - #https://askubuntu.com/questions/59383/extract-part-of-a-video-with-a-one-line-command

    - name: Update apt-get repo and cache
      apt:
        update_cache: yes 
        force_apt_get: yes 
        cache_valid_time: 3600

    - block:
      - name: Install base packages
        package:
          name: "{{ packages }}"
          state: present
        vars:
          packages:
            - git
            - vim
            - htop
            - ffmpeg
            - tree
            - make
            - gcc
            - ntp
            - yamllint
            - unzip
            - sysstat
            - curl
            - python-is-python3
            - ufw
            - neovim
            - python3-pip
            - build-essential
            - libssl-dev
            - libffi-dev
            - libpq-dev
            - python3-setuptools
            - python3-venv
            - neovim
        when: ansible_pkg_mgr == 'apt'
      
    - name: Remove dependencies that are no longer kequired
      apt:
        autoremove: yes
        purge: yes

    - name: Remove useless packages from the cache
      apt:
        autoclean: yes

    - name: Create locales
      locale_gen:
        name: "{{ item }}"
        state: present
      with_items:
        - en_US.UTF-8
        - fr_FR.UTF-8
      when: ansible_pkg_mgr == 'apt'

    - name: Set timezone to America/Toronto
      timezone:
        name: America/Toronto

    - name: Installing package for video cut
      pip:
        name: medipack 
